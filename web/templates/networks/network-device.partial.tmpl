{{$member := (get . "Member")}}
{{$network := (get . "Network")}}
<turbo-frame id="network-{{$network.Id}}-device-{{$member.Address}}">
  <article class="panel entity-panel" id="device-{{$member.Address}}">
    <header class="panel-heading">
      <h3 class="entity-name"><span class="tag zerotier-address">{{$member.Address}}</span></h3>
      <div class="tags">
        {{if (derefBool $member.Authorized)}}
        <span class="tag is-success">Authorized</span>
        {{else}}
        <span class="tag is-warning">Not authorized</span>
        {{end}}
        {{if (derefBool $member.ActiveBridge)}}
        <span class="tag is-info">Bridge</span>
        {{end}}
      </div>
    </header>
    <details data-accordion-item class="panel-block accordion-item">
      <summary class="accordion-header level">
        <h4>Basic Settings</h4>
        {{template "shared/accordion-icon.partial.tmpl"}}
      </summary>
      <div class="accordion-content">
        <h5 class="is-size-6">Network Membership</h5>
        <form
          action="/networks/{{$network.Id}}/devices/{{$member.Address}}"
          method="POST"
          data-controller="form-submission"
          data-action="submit->form-submission#submit"
        >
          <input type="hidden" id="create-method" name="method" value="{{if derefBool $member.Authorized}}DEAUTHORIZE{{else}}AUTHORIZE{{end}}">
          <div class="control" data-form-submission-target="submitter">
            <input
              class="button"
              type="submit"
              value="{{if derefBool $member.Authorized}}Revoke device authorization{{else}}Authorize device{{end}}"
              data-form-submission-target="submit"
            >
          </div>
        </form>
      </div>
    </details>
    <details data-accordion-item class="panel-block accordion-item">
      <summary class="accordion-header level">
        <h4>Advanced Details</h4>
        {{template "shared/accordion-icon.partial.tmpl"}}
      </summary>
      <div class="accordion-content">
        <h5 class="is-size-6">IP Assignments</h5>
        <p>
          {{range $ipAddr := $member.IpAssignments}}
          {{$ipAddr}}
          {{else}}
          <span class="tag is-warning">None</span>
          {{end}}
        </p>
        <h5 class="is-size-6">Troubleshooting Information</h5>
        <p>Configuration revision: {{$member.Revision}}</p>
        <p>
          Version:
          {{if eq -1 (derefInt $member.VMajor -1)}}
          <span class="tag is-warning">Unknown</span>
          {{else}}
          v{{$member.VMajor}}.{{$member.VMinor}}.{{$member.VRev}}
          {{end}}
        </p>
      </div>
    </details>
  </article>
</turbo-frame>
