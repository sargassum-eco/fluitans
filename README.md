# Fluitans

Server application for provisioning and managing ZeroTier networks, domain names, organizations, and registries

Named after [_Sargassum fluitans_](https://www.algaebase.org/search/species/detail/?tc=accept&species_id=825) (the broadleaf gulfweed), one of the dominant sargassum species found in the Sargasso Sea, this server application is a prototype for a user-friendly way of managing ZeroTier networks.

## Usage

The binaries generated by this project are entirely self-contained, except for the other services which Fluitans needs to talk to. You can simply run the Fluitans binary from anywhere, though you'll need to set some environment variables to specify how Fluitans should talk to the services it depends on.

### Development

Before you start the server for the first time, you'll need to generate the webapp build artifacts by running `make buildweb`. Then you can start the server using golang's `go run` by setting some environment variables and running `make run`. You will need to have installed golang first. Any time you modify the webapp files (in the web/app directory), you'll need to run `make buildweb` again to rebuild the bundled CSS and JS. Whenever you use a CSS selector in a template file (in the web/templates directory), you should *also* run `make buildweb`, because the build process for the bundled CSS omits any selectors not used by the templates.

### Building

To execute the full build pipeline, run `make`; to build the docker images, run `make build`. You will need to have installed golang and golangci-lint first; `make build` *should* automatically install golangci-lint, but this might not work; if not, you'll need to install it manually. Note that `make build` will also automatically regenerate the webapp build artifacts. The resulting built binaries can be found in directories within the dist directory corresponding to OS and CPU architecture (e.g. `./dist/fluitans_window_amd64/fluitans.exe` or `./dist/fluitans_linux_amd64/fluitans`)

### Environment Variables

You'll need to set some environment variables to tell Fluitans how to connect to a ZeroTier network controller. Specifically, you'll need to set:

- FLUITANS_ZT_CONTROLLER_SERVER, which should be the URL for the ZeroTier network controller's HTTP API. It needs to include the scheme `http://` or `https://`, for example `http://localhost:9993` or `https://zerotier-test.cloud.fluitans.org`.
- FLUITANS_ZT_CONTROLLER_AUTHTOKEN, which should be the contents of the authtoken.secret file saved by ZeroTier One in its working directory (more details [in ZeroTier's documentation](https://docs.zerotier.com/zerotier/zerotier.conf/)).

For example, you could run the server in development mode using:
```
FLUITANS_ZT_CONTROLLER_SERVER="http://localhost:9993" FLUITANS_ZT_CONTROLLER_AUTHTOKEN="0123456789abcdefghijklmn" make run
```

Or you could run the built binary using:
```
FLUITANS_ZT_CONTROLLER_SERVER="http://localhost:9993" FLUITANS_ZT_CONTROLLER_AUTHTOKEN="0123456789abcdefghijklmn" ./fluitans
```

## License

Copyright Prakash Lab and the Sargassum project contributors.

SPDX-License-Identifier: Apache-2.0 OR BlueOak-1.0.0

You can use this project either under the [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0) or under the [Blue Oak Model License 1.0.0](https://blueoakcouncil.org/license/1.0.0); you get to decide. We chose the Apache license because it's OSI-approved, and because it goes well together with the [Solderpad Hardware License](http://solderpad.org/licenses/SHL-2.1/), which is a license for open hardware used in other related projects but not this project. We prefer the Blue Oak Model License because it's easier to read and understand.
